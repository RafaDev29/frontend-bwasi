"use strict";(self["webpackChunkfrontend_ebox_platform"]=self["webpackChunkfrontend_ebox_platform"]||[]).push([[337],{7370:function(e,t,a){a.d(t,{L:function(){return s},R:function(){return o}});var r=a(1189);const n="https://api.bwasi.maquiadev.com/api/v1";function o(e){return r.A.get(`${n}/menu-navigation`,{headers:{Authorization:`Bearer ${e}`}})}function s(e,t){return r.A.patch(`${n}/menu-navigation`,t,{headers:{Authorization:`Bearer ${e}`}})}},8502:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var r=a(6768);const n={class:"containerlogin flex h-screen"},o={class:"form-wrapper relative w-full lg:w-3/10 h-full p-4 bg-white text-black shadow-lg"},s={class:"formLogin h-full flex flex-col justify-center"},i={key:0,class:"fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-75 z-[9999]"};function l(e,t,a,l,c,d){const u=(0,r.g2)("FormAuthVue");return(0,r.uX)(),(0,r.CE)("div",n,[(0,r.Lk)("div",o,[(0,r.Lk)("div",s,[(0,r.bF)(u,{onValidateLogin:l.onValidateLogin},null,8,["onValidateLogin"])])]),t[1]||(t[1]=(0,r.Lk)("div",{class:"image-background w-7/10 hidden lg:block"},null,-1)),l.isLoading?((0,r.uX)(),(0,r.CE)("div",i,t[0]||(t[0]=[(0,r.Lk)("div",{class:"flex flex-col items-center space-y-4"},[(0,r.Lk)("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white"}),(0,r.Lk)("p",{class:"text-white text-lg font-semibold"},"Cargando, por favor espera...")],-1)]))):(0,r.Q3)("",!0)])}a(4114);var c=a(144),d=a(1387),u=a(5130),m=a(554),p=a(9262),f=a(3651),g=a(1950),v=a(4587),b=a(1247),h=a(4600);const w=(0,v.j)({...(0,p.u)(),...(0,f.pE)()},"VForm"),x=(0,b.RW)()({name:"VForm",props:w(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,t){let{slots:a,emit:n}=t;const o=(0,f.DG)(e),s=(0,c.KR)();function i(e){e.preventDefault(),o.reset()}function l(e){const t=e,a=o.validate();t.then=a.then.bind(a),t.catch=a.catch.bind(a),t.finally=a.finally.bind(a),n("submit",t),t.defaultPrevented||a.then((e=>{let{valid:t}=e;t&&s.value?.submit()})),t.preventDefault()}return(0,h.C)((()=>(0,r.bF)("form",{ref:s,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:i,onSubmit:l},[a.default?.(o)]))),(0,g.O)(o,s)}});var L=a(4750);const k={class:"flex items-center justify-center min-h-screen bg-[#ffffff] p-4"},y={class:"w-full max-w-md bg-transparent shadow-none p-6"},A={class:"flex justify-center mb-4"},V=["src"];function E(e,t,a,n,o,s){return(0,r.uX)(),(0,r.CE)("div",k,[(0,r.Lk)("div",y,[(0,r.Lk)("div",A,[(0,r.Lk)("img",{src:o.LogoImage,alt:"Logo",class:"w-20 h-20"},null,8,V)]),t[3]||(t[3]=(0,r.Lk)("h1",{class:"text-lg text-[#6999c2] text-center mb-4 font-bold"},"Bienvenido de nuevo a eBeacons!!",-1)),t[4]||(t[4]=(0,r.Lk)("p",{class:"text-xs text-gray-900 text-center mb-4"}," Ingresa sus credenciales ",-1)),(0,r.bF)(x,{onSubmit:(0,u.D$)(n.validateLogin,["prevent"])},{default:(0,r.k6)((()=>[(0,r.bF)(L.W,{modelValue:n.username,"onUpdate:modelValue":t[0]||(t[0]=e=>n.username=e),label:"Usuario","prepend-inner-icon":"mdi-account-outline",variant:"outlined",color:"#0571ec",class:"text-black w-full mb-4"},null,8,["modelValue"]),(0,r.bF)(L.W,{modelValue:n.password,"onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),label:"Contraseña","append-inner-icon":n.showPassword?"mdi-eye-off":"mdi-eye",type:n.showPassword?"text":"password","prepend-inner-icon":"mdi-lock-outline",variant:"outlined",color:"#0571ec",class:"text-black w-full mb-4","onClick:appendInner":n.togglePasswordVisibility},null,8,["modelValue","append-inner-icon","type","onClick:appendInner"]),(0,r.bF)(m.D,{type:"submit",color:"#6999c2",class:"w-full mt-4 font-bold"},{default:(0,r.k6)((()=>t[2]||(t[2]=[(0,r.eW)("Ingresar")]))),_:1})])),_:1},8,["onSubmit"]),t[5]||(t[5]=(0,r.Lk)("div",{class:"mt-8 text-gray-400 text-sm text-center"},[(0,r.Lk)("p",{class:"font-semibold"}," Presencia en tiempo real, "),(0,r.Lk)("p",null," decisiones al instante. ")],-1))])])}var R=a.p+"img/logo_sysnet.a54a9cf0.png",C={data(){return{LogoImage:R}},emits:["validate-login"],setup(e,{emit:t}){const a=(0,c.KR)(""),r=(0,c.KR)(""),n=(0,c.KR)(!1),o=()=>{const e={username:a.value,password:r.value};t("validate-login",e)},s=()=>{n.value=!n.value};return{username:a,password:r,validateLogin:o,togglePasswordVisibility:s,showPassword:n}}},_=a(1241);const F=(0,_.A)(C,[["render",E],["__scopeId","data-v-1fdcea45"]]);var I=F,K=a(1189);const P="https://api.bwasi.maquiadev.com/api/v1";function q(e){return K.A.post(`${P}/auth/login`,e)}var D=a(7370),S=a(5129),$=a(4874),j=a.n($),U={components:{FormAuthVue:I},setup(){const e=(0,c.KR)(!1),t=(0,c.KR)(""),a=(0,c.KR)(!1),n=(0,d.rd)(),o=(0,d.lq)(),s=()=>{e.value=!0},i=()=>{e.value=!1},l=async e=>{try{const t=await(0,D.R)(e);t.status&&Array.isArray(t.data.data)?S.A.commit("setMenuData",t.data.data):console.error("La respuesta del menú no es válida:",t)}catch(t){console.error("Error al obtener el menú:",t),j().fire({icon:"error",title:"Error al cargar el menú",text:"No se pudo obtener la configuración del menú de navegación."})}},u=async e=>{try{s();const t=await q(e),a=t.data.data,r=a.token;S.A.commit("setUsername",a.username),S.A.commit("setToken",r),S.A.commit("setRole",a.role),S.A.commit("setLogo",a.logoName),S.A.commit("setIsAuthenticated",!0),S.A.commit("setCustomerid",a.customerId),"CUSTOMER_MASTER"===S.A.state.role&&await l(r),i(),n.push("/")}catch(t){console.error("Error en el proceso de inicio de sesión:",t),i(),t.response?401===t.response.status?j().fire({icon:"error",title:"Credenciales inválidas",text:"Las credenciales de usuario no son válidas"}):500===t.response.status?j().fire({icon:"error",title:"Error del servidor",text:"Error 500: Error interno del servidor"}):j().fire({icon:"error",title:"Error",text:t.response.data.message}):t.request?j().fire({icon:"error",title:"Sin respuesta",text:"No se recibió respuesta del servidor"}):j().fire({icon:"error",title:"Error de solicitud",text:"Error al configurar la solicitud: "+t.message})}};return(0,r.sV)((()=>{const e=o.query.username,t=o.query.password;e&&t&&u({username:e,password:t})})),{onValidateLogin:u,messageError:t,statusError:a,openLoading:s,closeLoading:i,isLoading:e}}};const B=(0,_.A)(U,[["render",l],["__scopeId","data-v-80e6af10"]]);var W=B}}]);
//# sourceMappingURL=337.cfa1e159.js.map